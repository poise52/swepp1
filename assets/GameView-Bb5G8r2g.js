import{u as me,M as de}from"./MainLayout-C7APwl5I.js";import{r as $,c as T,w as ce,d as Q,o as b,a as y,b as s,u as p,t as V,F as Z,e as ee,n as K,f as O,v as A,g as W,h as R,i as P,j as ve,k as ie,l as te,m as se,p as fe}from"./index-CL5NxHxL.js";function ge(n){return function(){let m=n+=1831565813;return m=Math.imul(m^m>>>15,m|1),m^=m+Math.imul(m^m>>>7,m|61),((m^m>>>14)>>>0)/4294967296}}function pe(){const n=$([]),m=$("idle"),d=$(0),C=$(0),a=$(0),h=$(0),k=$(0),f=$(new Set);let g=null,o=!0,v=Math.random,x=null;const G=T(()=>n.value.flat().filter(l=>l.mark==="flag").length),M=(l,t)=>{const r=[];for(let c=-1;c<=1;c++)for(let u=-1;u<=1;u++){if(c===0&&u===0)continue;const _=l+c,w=t+u;_>=0&&_<a.value&&w>=0&&w<h.value&&r.push(n.value[_][w])}return r},U=()=>{const l=[];for(let t=0;t<a.value;t++){const r=[];for(let c=0;c<h.value;c++)r.push({row:t,col:c,isMine:!1,isOpen:!1,mark:"none",adjacentMines:0});l.push(r)}return l},H=()=>{v=ge(k.value);const l=[];for(let t=0;t<a.value;t++)for(let r=0;r<h.value;r++)l.push({r:t,c:r});for(let t=l.length-1;t>0;t--){const r=Math.floor(v()*(t+1));[l[t],l[r]]=[l[r],l[t]]}for(let t=0;t<d.value&&t<l.length;t++){const r=l[t];n.value[r.r][r.c].isMine=!0}},e=(l,t)=>{const r=[];for(let u=-1;u<=1;u++)for(let _=-1;_<=1;_++){const w=l+u,j=t+_;w>=0&&w<a.value&&j>=0&&j<h.value&&n.value[w][j].isMine&&r.push({r:w,c:j})}if(r.length===0)return;const c=[];for(let u=0;u<a.value;u++)for(let _=0;_<h.value;_++)!(Math.abs(u-l)<=1&&Math.abs(_-t)<=1)&&!n.value[u][_].isMine&&c.push({r:u,c:_});for(let u=0;u<r.length&&u<c.length;u++){const _=r[u],w=c[u];n.value[_.r][_.c].isMine=!1,n.value[w.r][w.c].isMine=!0}},i=()=>{for(let l=0;l<a.value;l++)for(let t=0;t<h.value;t++)if(!n.value[l][t].isMine){const r=M(l,t);n.value[l][t].adjacentMines=r.filter(c=>c.isMine).length}},I=(l,t)=>{const r=n.value[l][t];if(!(r.isOpen||r.mark==="flag")&&(r.isOpen=!0,r.adjacentMines===0&&!r.isMine)){const c=M(l,t);for(const u of c)!u.isOpen&&!u.isMine&&I(u.row,u.col)}},B=()=>{for(let l=0;l<a.value;l++)for(let t=0;t<h.value;t++)n.value[l][t].isMine&&(n.value[l][t].isOpen=!0)},q=()=>{for(let l=0;l<a.value;l++)for(let t=0;t<h.value;t++)n.value[l][t].isMine&&(n.value[l][t].mark="flag")},X=()=>{for(let l=0;l<a.value;l++)for(let t=0;t<h.value;t++){const r=n.value[l][t];if(!r.isMine&&!r.isOpen)return!1}return!0},Y=()=>{g||(g=window.setInterval(()=>{C.value++},1e3))},D=()=>{g&&(clearInterval(g),g=null)},L=(l,t,r,c,u)=>{D(),a.value=l,h.value=t,d.value=r,C.value=0,m.value="idle",o=!0,k.value=c??Math.floor(Math.random()*1e6),x=u||null,n.value=U(),H()},N=(l,t,r)=>{if(m.value==="won"||m.value==="lost")return;const c=r||x,u=n.value[l][t];if(u.isOpen&&u.adjacentMines>0){if(!(c!=null&&c.enableChord))return;const _=M(l,t),w=_.filter(S=>S.mark==="flag").length,j=_.filter(S=>!S.isOpen&&S.mark!=="flag").length;if(j===u.adjacentMines-w&&j>0){for(const S of _)!S.isOpen&&S.mark!=="flag"&&(S.mark="flag");return}if(w===u.adjacentMines)for(const S of _)!S.isOpen&&S.mark!=="flag"&&N(S.row,S.col,r);return}if(!(u.isOpen||u.mark==="flag")){if(o&&(o=!1,(c==null?void 0:c.fieldGeneration)!=="random"&&e(l,t),i(),m.value="playing",Y()),u.isMine){if(c!=null&&c.devMode)return;u.isOpen=!0,B(),m.value="lost",D();return}I(l,t),X()&&(m.value="won",q(),D())}};return{board:n,gameStatus:m,minesCount:d,flagsCount:G,time:C,rows:a,cols:h,seed:k,highlightedCells:f,initGame:L,openCell:N,cycleMark:(l,t,r)=>{if(m.value==="won"||m.value==="lost")return;const c=r||x,u=n.value[l][t];if(u.isOpen)return;const w=(c==null?void 0:c.showQuestionMarks)!==!1?["none","flag","question"]:["none","flag"],j=w.indexOf(u.mark);u.mark=w[(j+1)%w.length]},restartGame:()=>{L(a.value,h.value,d.value,k.value)},newGame:()=>{L(a.value,h.value,d.value)},highlightNeighbors:(l,t)=>{const r=n.value[l][t];if(!r.isOpen||r.adjacentMines===0)return;f.value.clear();const c=M(l,t);for(const u of c)!u.isOpen&&u.mark!=="flag"&&f.value.add(`${u.row}-${u.col}`)},clearHighlight:()=>{f.value.clear()}}}const ue="minesweeper-settings",ne={fieldGeneration:"safe-start",showQuestionMarks:!0,enableChord:!0,scale:100,devMode:!1},he=()=>{try{const n=localStorage.getItem(ue);if(n)return{...ne,...JSON.parse(n)}}catch{}return{...ne}},F=$(he());function re(){return ce(F,d=>{localStorage.setItem(ue,JSON.stringify(d))},{deep:!0}),{settings:F,updateSetting:(d,C)=>{F.value[d]=C},resetSettings:()=>{F.value={...ne}}}}const _e={class:"ms-menu"},Me={class:"ms-menu__header"},be=["title"],ke={class:"ms-menu__section"},we={class:"ms-menu__difficulties"},ye=["value"],Ce={class:"ms-menu__radio-content"},xe={class:"ms-menu__radio-label"},$e={class:"ms-menu__radio-info"},Se={class:"ms-menu__custom-difficulty"},Oe={class:"ms-menu__radio-content"},Ge={key:0,class:"ms-menu__radio-info"},He={key:0,class:"ms-menu__custom-inline"},Ve={class:"ms-menu__inline-field"},Ne={class:"ms-menu__inline-field"},je={class:"ms-menu__inline-field"},Ue=["max"],Ie={class:"ms-menu__section"},Be={class:"ms-menu__settings-grid"},Ee={class:"ms-menu__setting-group"},Te={class:"ms-menu__options"},Qe={class:"ms-menu__radio ms-menu__radio--small"},qe={class:"ms-menu__radio ms-menu__radio--small"},De={class:"ms-menu__setting-group"},Le={class:"ms-menu__options"},Re={class:"ms-menu__checkbox"},Ze={class:"ms-menu__checkbox"},Ae={class:"ms-menu__checkbox"},Fe={class:"ms-menu__scale-row"},ze={class:"ms-menu__scale"},Je={class:"ms-menu__scale-value"},Ke={class:"ms-menu__seed-row"},We=["disabled"],z=5,J=50,oe=1,Xe=Q({__name:"MinesweeperMenu",emits:["start"],setup(n,{emit:m}){const{theme:d,toggleTheme:C}=me(),{settings:a}=re(),h=[{name:"ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº",rows:9,cols:9,mines:10},{name:"Ð›ÑŽÐ±Ð¸Ñ‚ÐµÐ»ÑŒ",rows:16,cols:16,mines:40},{name:"Ð­ÐºÑÐ¿ÐµÑ€Ñ‚",rows:16,cols:30,mines:99}],k=m,f=$("ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº"),g=$(10),o=$(10),v=$(15),x=$(""),G=T(()=>Math.floor(g.value*o.value*.8)),M=T(()=>f.value==="custom"?g.value>=z&&g.value<=J&&o.value>=z&&o.value<=J&&v.value>=oe&&v.value<=G.value:!0),U=()=>{let H,e,i;if(f.value==="custom")H=g.value,e=o.value,i=v.value;else{const B=h.find(q=>q.name===f.value);H=B.rows,e=B.cols,i=B.mines}const I=x.value?parseInt(x.value):void 0;k("start",H,e,i,I)};return(H,e)=>(b(),y("div",_e,[s("div",Me,[e[13]||(e[13]=s("h1",{class:"ms-menu__title"},"Ð¡Ð°Ð¿Ñ‘Ñ€",-1)),s("button",{class:"ms-menu__theme-btn",onClick:e[0]||(e[0]=(...i)=>p(C)&&p(C)(...i)),title:p(d)==="light"?"Ð¢Ñ‘Ð¼Ð½Ð°Ñ Ñ‚ÐµÐ¼Ð°":"Ð¡Ð²ÐµÑ‚Ð»Ð°Ñ Ñ‚ÐµÐ¼Ð°"},V(p(d)==="light"?"ðŸŒ™":"â˜€ï¸"),9,be)]),s("div",ke,[e[20]||(e[20]=s("div",{class:"ms-menu__section-title"},"Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ",-1)),s("div",we,[(b(),y(Z,null,ee(h,i=>s("label",{key:i.name,class:K(["ms-menu__radio ms-menu__radio--diff",{"ms-menu__radio--selected":f.value===i.name}])},[O(s("input",{type:"radio",name:"difficulty",value:i.name,"onUpdate:modelValue":e[1]||(e[1]=I=>f.value=I)},null,8,ye),[[A,f.value]]),e[14]||(e[14]=s("span",{class:"ms-menu__radio-mark"},null,-1)),s("span",Ce,[s("span",xe,V(i.name),1),s("span",$e,V(i.cols)+"Ã—"+V(i.rows)+" Â· "+V(i.mines)+" Ð¼Ð¸Ð½",1)])],2)),64)),s("div",Se,[s("label",{class:K(["ms-menu__radio ms-menu__radio--diff",{"ms-menu__radio--selected":f.value==="custom"}])},[O(s("input",{type:"radio",name:"difficulty",value:"custom","onUpdate:modelValue":e[2]||(e[2]=i=>f.value=i)},null,512),[[A,f.value]]),e[16]||(e[16]=s("span",{class:"ms-menu__radio-mark"},null,-1)),s("span",Oe,[e[15]||(e[15]=s("span",{class:"ms-menu__radio-label"},"Ð¡Ð²Ð¾Ñ",-1)),f.value!=="custom"?(b(),y("span",Ge,"Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ñ€Ð°Ð·Ð¼ÐµÑ€")):W("",!0)])],2),f.value==="custom"?(b(),y("div",He,[s("div",Ve,[e[17]||(e[17]=s("label",null,"Ð¨Ð¸Ñ€Ð¸Ð½Ð°:",-1)),O(s("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=i=>o.value=i),min:z,max:J},null,512),[[R,o.value,void 0,{number:!0}]])]),s("div",Ne,[e[18]||(e[18]=s("label",null,"Ð’Ñ‹ÑÐ¾Ñ‚Ð°:",-1)),O(s("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=i=>g.value=i),min:z,max:J},null,512),[[R,g.value,void 0,{number:!0}]])]),s("div",je,[e[19]||(e[19]=s("label",null,"ÐœÐ¸Ð½Ñ‹:",-1)),O(s("input",{type:"number","onUpdate:modelValue":e[5]||(e[5]=i=>v.value=i),min:oe,max:G.value},null,8,Ue),[[R,v.value,void 0,{number:!0}]])])])):W("",!0)])])]),s("div",Ie,[e[35]||(e[35]=s("div",{class:"ms-menu__section-title"},"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸",-1)),s("div",Be,[s("div",Ee,[e[25]||(e[25]=s("div",{class:"ms-menu__setting-label"},"Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»Ñ",-1)),s("div",Te,[s("label",Qe,[O(s("input",{type:"radio",name:"fieldGen",value:"safe-start","onUpdate:modelValue":e[6]||(e[6]=i=>p(a).fieldGeneration=i)},null,512),[[A,p(a).fieldGeneration]]),e[21]||(e[21]=s("span",{class:"ms-menu__radio-mark"},null,-1)),e[22]||(e[22]=s("span",{class:"ms-menu__radio-label"},"Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚",-1))]),s("label",qe,[O(s("input",{type:"radio",name:"fieldGen",value:"random","onUpdate:modelValue":e[7]||(e[7]=i=>p(a).fieldGeneration=i)},null,512),[[A,p(a).fieldGeneration]]),e[23]||(e[23]=s("span",{class:"ms-menu__radio-mark"},null,-1)),e[24]||(e[24]=s("span",{class:"ms-menu__radio-label"},"Ð¡Ð»ÑƒÑ‡Ð°Ð¹Ð½Ð¾Ðµ",-1))])])]),s("div",De,[e[32]||(e[32]=s("div",{class:"ms-menu__setting-label"},"ÐžÐ¿Ñ†Ð¸Ð¸",-1)),s("div",Le,[s("label",Re,[O(s("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=i=>p(a).showQuestionMarks=i)},null,512),[[P,p(a).showQuestionMarks]]),e[26]||(e[26]=s("span",{class:"ms-menu__checkbox-mark"},null,-1)),e[27]||(e[27]=s("span",{class:"ms-menu__checkbox-label"},"Ð—Ð½Ð°ÐºÐ¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°",-1))]),s("label",Ze,[O(s("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=i=>p(a).enableChord=i)},null,512),[[P,p(a).enableChord]]),e[28]||(e[28]=s("span",{class:"ms-menu__checkbox-mark"},null,-1)),e[29]||(e[29]=s("span",{class:"ms-menu__checkbox-label"},"Ð Ð°Ð·Ð¾Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ",-1))]),s("label",Ae,[O(s("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=i=>p(a).devMode=i)},null,512),[[P,p(a).devMode]]),e[30]||(e[30]=s("span",{class:"ms-menu__checkbox-mark"},null,-1)),e[31]||(e[31]=s("span",{class:"ms-menu__checkbox-label"},"Ð ÐµÐ¶Ð¸Ð¼ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ°",-1))])])])]),s("div",Fe,[e[33]||(e[33]=s("span",{class:"ms-menu__setting-label"},"ÐœÐ°ÑÑˆÑ‚Ð°Ð±",-1)),s("div",ze,[O(s("input",{type:"range",min:"50",max:"150",step:"10","onUpdate:modelValue":e[11]||(e[11]=i=>p(a).scale=i)},null,512),[[R,p(a).scale,void 0,{number:!0}]]),s("span",Je,V(p(a).scale)+"%",1)])]),s("div",Ke,[e[34]||(e[34]=s("span",{class:"ms-menu__setting-label"},"Seed",-1)),O(s("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=i=>x.value=i),placeholder:"ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ð¹"},null,512),[[R,x.value]])])]),s("button",{class:"ms-menu__btn ms-menu__btn--start",disabled:!M.value,onClick:U}," ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¸Ð³Ñ€Ñƒ ",8,We)]))}}),Ye={class:"minesweeper__header"},Pe={class:"minesweeper__display"},es={class:"minesweeper__display"},ss={class:"minesweeper__seed"},ns=Q({__name:"MinesweeperHeader",props:{minesLeft:{},time:{},gameStatus:{},seed:{}},emits:["restart","newGame","back"],setup(n,{emit:m}){const d=m,C=h=>String(Math.min(999,Math.max(-99,h))).padStart(3,"0"),a=h=>{switch(h){case"won":return"ðŸ˜Ž";case"lost":return"ðŸ˜µ";default:return"ðŸ™‚"}};return(h,k)=>(b(),y(Z,null,[s("div",Ye,[s("button",{class:"minesweeper__back pi pi-arrow-left",onClick:k[0]||(k[0]=f=>d("back")),title:"Ð’ Ð¼ÐµÐ½ÑŽ"}),s("div",Pe,V(C(n.minesLeft)),1),s("button",{class:"minesweeper__restart",onClick:k[1]||(k[1]=f=>d("restart")),title:"ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ (Ñ‚Ð¾Ñ‚ Ð¶Ðµ seed)"},V(a(n.gameStatus)),1),s("div",es,V(C(n.time)),1),s("button",{class:"minesweeper__new-game pi pi-refresh",onClick:k[2]||(k[2]=f=>d("newGame")),title:"ÐÐ¾Ð²Ð°Ñ Ð¸Ð³Ñ€Ð°"})]),s("div",ss,"seed: "+V(n.seed),1)],64))}}),ts={key:0,class:"ms-cell__flag"},ls={key:1,class:"ms-cell__question"},as={key:2,class:"ms-cell__mine"},os={key:3,class:"ms-cell__dev-mine"},is={key:4},us=Q({__name:"MinesweeperCell",props:{cell:{},gameStatus:{},isHighlighted:{type:Boolean},devMode:{type:Boolean}},emits:["open","mark","highlight","clearHighlight"],setup(n,{emit:m}){const d=m,C=o=>{o.isOpen&&o.adjacentMines>0&&d("highlight",o.row,o.col)},a=o=>{d("clearHighlight")},h=o=>{d("open",o.row,o.col)},k=(o,v)=>{o.preventDefault(),d("mark",v.row,v.col)},f=(o,v,x,G)=>{const M=["ms-cell"];return o.isOpen?(M.push("ms-cell--open"),o.isMine?(M.push("ms-cell--mine"),v==="lost"&&M.push("ms-cell--exploded")):o.adjacentMines>0&&M.push(`ms-cell--num-${o.adjacentMines}`)):(M.push("ms-cell--closed"),x&&M.push("ms-cell--highlighted"),G&&o.isMine&&o.mark!=="flag"&&M.push("ms-cell--dev-mine")),M},g=(o,v)=>o.isOpen?o.isMine?{type:"mine"}:o.adjacentMines>0?{type:"number",value:o.adjacentMines}:null:o.mark==="flag"?{type:"flag"}:o.mark==="question"?{type:"question"}:v&&o.isMine?{type:"dev-mine"}:null;return(o,v)=>{var x,G,M,U,H,e;return b(),y("button",{class:K(f(n.cell,n.gameStatus,n.isHighlighted,n.devMode)),onMousedown:v[0]||(v[0]=i=>C(n.cell)),onMouseup:v[1]||(v[1]=i=>a(n.cell)),onMouseleave:v[2]||(v[2]=i=>d("clearHighlight")),onClick:v[3]||(v[3]=i=>h(n.cell)),onContextmenu:v[4]||(v[4]=i=>k(i,n.cell))},[g(n.cell,n.devMode)?(b(),y(Z,{key:0},[((x=g(n.cell,n.devMode))==null?void 0:x.type)==="flag"?(b(),y("span",ts,[...v[5]||(v[5]=[s("i",{class:"pi pi-flag-fill"},null,-1)])])):((G=g(n.cell,n.devMode))==null?void 0:G.type)==="question"?(b(),y("span",ls,"?")):((M=g(n.cell,n.devMode))==null?void 0:M.type)==="mine"?(b(),y("span",as,"ðŸ’£")):((U=g(n.cell,n.devMode))==null?void 0:U.type)==="dev-mine"?(b(),y("span",os,"ðŸ’£")):((H=g(n.cell,n.devMode))==null?void 0:H.type)==="number"?(b(),y("span",is,V((e=g(n.cell,n.devMode))==null?void 0:e.value),1)):W("",!0)],64)):W("",!0)],34)}}}),rs=Q({__name:"MinesweeperBoard",props:{board:{},gameStatus:{},cols:{},highlightedCells:{},devMode:{type:Boolean}},emits:["cellOpen","cellMark","cellHighlight","clearHighlight"],setup(n,{emit:m}){const d=m;return(C,a)=>(b(),y("div",{class:"minesweeper__board",style:ie({gridTemplateColumns:`repeat(${n.cols}, 32px)`}),onContextmenu:a[4]||(a[4]=ve(()=>{},["prevent"]))},[(b(!0),y(Z,null,ee(n.board,(h,k)=>(b(),y("div",{key:k,class:"minesweeper__row"},[(b(!0),y(Z,null,ee(h,f=>(b(),te(us,{key:`${f.row}-${f.col}`,cell:f,"game-status":n.gameStatus,"is-highlighted":n.highlightedCells.has(`${f.row}-${f.col}`),"dev-mode":n.devMode,onOpen:a[0]||(a[0]=(g,o)=>d("cellOpen",g,o)),onMark:a[1]||(a[1]=(g,o)=>d("cellMark",g,o)),onHighlight:a[2]||(a[2]=(g,o)=>d("cellHighlight",g,o)),onClearHighlight:a[3]||(a[3]=g=>d("clearHighlight"))},null,8,["cell","game-status","is-highlighted","dev-mode"]))),128))]))),128))],36))}}),ms=Q({__name:"MinesweeperGame",setup(n){const m=$(!0),{settings:d}=re(),{board:C,gameStatus:a,minesCount:h,flagsCount:k,time:f,cols:g,seed:o,highlightedCells:v,initGame:x,openCell:G,cycleMark:M,restartGame:U,newGame:H,highlightNeighbors:e,clearHighlight:i}=pe(),I=T(()=>h.value-k.value),B=T(()=>({minesweeper:!0,"minesweeper--won":a.value==="won","minesweeper--lost":a.value==="lost"})),q=T(()=>({transform:`scale(${d.value.scale/100})`,transformOrigin:"top center"})),X=(N,E)=>{G(N,E,d.value)},Y=(N,E)=>{M(N,E,d.value)},D=(N,E,le,ae)=>{x(N,E,le,ae,d.value),m.value=!1},L=()=>{m.value=!0};return(N,E)=>m.value?(b(),te(Xe,{key:0,onStart:D})):(b(),y("div",{key:1,class:K(B.value),style:ie(q.value)},[se(ns,{"mines-left":I.value,time:p(f),"game-status":p(a),seed:p(o),onRestart:p(U),onNewGame:p(H),onBack:L},null,8,["mines-left","time","game-status","seed","onRestart","onNewGame"]),se(rs,{board:p(C),"game-status":p(a),cols:p(g),"highlighted-cells":p(v),"dev-mode":p(d).devMode,onCellOpen:X,onCellMark:Y,onCellHighlight:p(e),onClearHighlight:p(i)},null,8,["board","game-status","cols","highlighted-cells","dev-mode","onCellHighlight","onClearHighlight"])],6))}}),gs=Q({__name:"GameView",setup(n){return(m,d)=>(b(),te(de,null,{default:fe(()=>[se(ms)]),_:1}))}});export{gs as default};
